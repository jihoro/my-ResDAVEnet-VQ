Downloading: "https://download.pytorch.org/models/resnet50-19c8e357.pth" to /root/.cache/torch/hub/checkpoints/resnet50-19c8e357.pth

  0%|          | 0.00/97.8M [00:00<?, ?B/s]
 19%|█▉        | 18.5M/97.8M [00:00<00:00, 194MB/s]
 50%|█████     | 49.1M/97.8M [00:00<00:00, 220MB/s]
 79%|███████▉  | 77.4M/97.8M [00:00<00:00, 239MB/s]
100%|██████████| 97.8M/97.8M [00:00<00:00, 276MB/s]I am process 324, running on 02bae8324721: starting (Fri Oct  2 07:33:54 2020)
audio_model                              : ResDavenetVQ
image_model                              : Resnet50
freeze_image_model                       : False
pretrained_image_model                   : True
seed_dir                                 : 
seed_epoch                               : -1
margin                                   : 1.0
layer_widths                             : 128,256,256,512,1024
layer_depths                             : 2,2,2,2
convsize                                 : 9
seed                                     : 8675309
VQ_commitment_cost                       : 1
VQ_turnon                                : 0,1,1,0,0
VQ_sizes                                 : 1024,1024,1024,1024,1024
nonneg_init                              : False
init_std                                 : 1
init_ema_mass                            : 1
jitter                                   : 0.12
optim                                    : adam
batch_size                               : 64
lr                                       : 0.0002
lr_decay                                 : 3
lr_decay_multiplier                      : 0.95
momentum                                 : 0.9
weight_decay                             : 5e-07
force_start_epoch                        : 0
n_epochs                                 : 150
n_print_steps                            : 100
save_every                               : 10
num_workers                              : 8
loading data from ../gdrive/My Drive/flickr8k_spoken_captions/flickr8k_train.json / ../gdrive/My Drive/flickr8k_spoken_captions/flickr8k_dev.json

Creating experiment directory: ./exps/RDVQ_01100
Found 1 GPUs
Total 226 trainable parameters
current #steps=0, #epochs=1
start training...
cuda
Learning rate @     1 is 0.000200

Epoch: [1][100/469]  Time=2.142 (16.278)  Data=0.014 (14.251)  Loss=1.230 (1.095)  Bwd=0.898 (0.933)  Loss total=6.7110 (13.6903)  QLoss=(None, 1.748, 1.127, None, None)  Perplexity=(None, 18.359, 4.705, None, None)
Epoch: [1][200/469]  Time=2.062 (14.198)  Data=0.004 (12.161)  Loss=1.128 (1.105)  Bwd=0.931 (0.932)  Loss total=5.8402 (10.1088)  QLoss=(None, 1.382, 0.670, None, None)  Perplexity=(None, 19.095, 5.163, None, None)
Epoch: [1][300/469]  Time=1.810 (13.315)  Data=0.010 (11.301)  Loss=0.859 (1.080)  Bwd=0.942 (0.935)  Loss total=5.6197 (8.6633)  QLoss=(None, 1.176, 0.771, None, None)  Perplexity=(None, 20.783, 7.167, None, None)
Epoch: [1][400/469]  Time=1.852 (13.152)  Data=0.005 (11.136)  Loss=0.930 (1.081)  Bwd=0.917 (0.935)  Loss total=5.0427 (7.8042)  QLoss=(None, 0.918, 0.316, None, None)  Perplexity=(None, 22.443, 6.331, None, None)
WARNING: truncate 361/2409 frames
WARNING: truncate 30303/32351 frames
tcmalloc: large alloc 2621440000 bytes == 0x7f03e5c00000 @  0x7f07cb94fb6b 0x7f07cb96f379 0x7f0777ef892e 0x7f0777efa946 0x7f07b02d6bb3 0x7f07afd8b17a 0x7f07afd8c293 0x7f07b028cedf 0x7f07afe1a6a6 0x7f07afe1b7b0 0x7f07b00721c9 0x7f07afa13689 0x7f07b0151919 0x7f07afe1d09b 0x7f07b0207a08 0x7f07afa13689 0x7f07b0151709 0x7f07b1e03fc7 0x7f07afa13689 0x7f07b0151709 0x7f07bf8c8a0e 0x50a7f5 0x50c1f4 0x509918 0x50a64d 0x50c1f4 0x507f24 0x509c50 0x50a64d 0x50c1f4 0x507f24
WARNING: truncate 7497/9545 frames
 * Audio R@10 0.003 / Image R@10 0.003 / Mean R@10 0.003 over 5000 validation pairs
 * Audio R@5 0.002 / Image R@5 0.002 / Mean R@5 0.002 over 5000 validation pairs
 * Audio R@1 0.000 / Image R@1 0.000 / Mean R@1 0.000 over 5000 validation pairs
Finished epoch 1. Time elapsed = 10472s. Current Time = 2020-10-02 10:28:40.775297
Learning rate @     2 is 0.000200
[W accumulate_grad.h:165] Warning: grad and param do not obey the gradient layout contract. This is not an error, but may impair performance.
grad.sizes() = [256, 256, 1, 1], strides() = [256, 1, 1, 1]
param.sizes() = [256, 256, 1, 1], strides() = [256, 1, 256, 256] (function operator())
Epoch: [2][31/469]  Time=2.327 (14.350)  Data=0.001 (12.312)  Loss=1.352 (1.100)  Bwd=0.971 (0.938)  Loss total=4.7587 (7.2403)  QLoss=(None, 0.782, 0.273, None, None)  Perplexity=(None, 22.561, 6.539, None, None)
Epoch: [2][131/469]  Time=2.480 (15.633)  Data=0.006 (13.526)  Loss=1.487 (1.162)  Bwd=0.988 (0.946)  Loss total=4.4008 (6.8029)  QLoss=(None, 0.717, 0.239, None, None)  Perplexity=(None, 21.869, 6.260, None, None)
Epoch: [2][231/469]  Time=2.596 (15.681)  Data=0.034 (13.524)  Loss=1.516 (1.205)  Bwd=1.046 (0.952)  Loss total=4.7954 (6.4769)  QLoss=(None, 0.686, 0.482, None, None)  Perplexity=(None, 22.325, 7.227, None, None)
Epoch: [2][331/469]  Time=110.742 (15.894)  Data=108.347 (13.705)  Loss=1.445 (1.233)  Bwd=0.950 (0.956)  Loss total=4.0599 (6.2144)  QLoss=(None, 0.588, 0.180, None, None)  Perplexity=(None, 23.307, 6.237, None, None)
Epoch: [2][431/469]  Time=2.454 (15.717)  Data=0.006 (13.508)  Loss=1.484 (1.250)  Bwd=0.964 (0.958)  Loss total=4.3985 (5.9876)  QLoss=(None, 0.493, 0.173, None, None)  Perplexity=(None, 24.559, 6.319, None, None)
WARNING: truncate 361/2409 frames
WARNING: truncate 30303/32351 frames
tcmalloc: large alloc 2621440000 bytes == 0x102ae0000 @  0x7f07cb94fb6b 0x7f07cb96f379 0x7f0777ef892e 0x7f0777efa946 0x7f07b02d6bb3 0x7f07afd8b17a 0x7f07afd8c293 0x7f07b028cedf 0x7f07afe1a6a6 0x7f07afe1b7b0 0x7f07b00721c9 0x7f07afa13689 0x7f07b0151919 0x7f07afe1d09b 0x7f07b0207a08 0x7f07afa13689 0x7f07b0151709 0x7f07b1e03fc7 0x7f07afa13689 0x7f07b0151709 0x7f07bf8c8a0e 0x50a7f5 0x50c1f4 0x509918 0x50a64d 0x50c1f4 0x507f24 0x509c50 0x50a64d 0x50c1f4 0x507f24
WARNING: truncate 7497/9545 frames
 * Audio R@10 0.003 / Image R@10 0.006 / Mean R@10 0.005 over 5000 validation pairs
 * Audio R@5 0.002 / Image R@5 0.002 / Mean R@5 0.002 over 5000 validation pairs
 * Audio R@1 0.000 / Image R@1 0.000 / Mean R@1 0.000 over 5000 validation pairs
Finished epoch 2. Time elapsed = 11239s. Current Time = 2020-10-02 13:36:04.366988
Learning rate @     3 is 0.000190
Epoch: [3][62/469]  Time=2.334 (16.478)  Data=0.014 (14.258)  Loss=1.369 (1.262)  Bwd=0.952 (0.958)  Loss total=3.7759 (5.7824)  QLoss=(None, 0.377, 0.152, None, None)  Perplexity=(None, 24.386, 7.051, None, None)
Epoch: [3][162/469]  Time=2.425 (16.642)  Data=0.001 (14.404)  Loss=1.448 (1.278)  Bwd=0.976 (0.960)  Loss total=4.1088 (5.6178)  QLoss=(None, 0.409, 0.221, None, None)  Perplexity=(None, 25.095, 8.862, None, None)
Traceback (most recent call last):
  File "run_ResDavenetVQ.py", line 225, in <module>
    args, exp_dir, resume)
  File "/content/my-ResDAVEnet-VQ/steps/traintest.py", line 135, in train
    for i, (image_input, audio_input, nframes) in enumerate(train_loader):
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py", line 363, in __next__
    data = self._next_data()
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py", line 974, in _next_data
    idx, data = self._get_data()
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py", line 931, in _get_data
    success, data = self._try_get_data()
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py", line 779, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/usr/lib/python3.6/queue.py", line 173, in get
    self.not_empty.wait(remaining)
  File "/usr/lib/python3.6/threading.py", line 299, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt
